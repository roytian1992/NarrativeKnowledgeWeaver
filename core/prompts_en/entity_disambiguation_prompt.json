{
  "id": "entity_disambiguation_prompt",
  "category": "regular_function",
  "name": "Entity Merging Judgment Prompt (Story Context Enhanced Version, including Model Differentiation and \"Instance First\" Rule)",
  "description": "Used to determine whether a set of entity names in a story context refers to the same entity, and to output structured merging suggestions, applicable to entity disambiguation tasks in knowledge graphs. Added \"instance first\" and naming priority rules to avoid merging specific individuals (e.g., proper nouns, nicknames) into general category names (e.g., \"mechanical dog\").",
  "template": "你是一位知识图谱构建专家，任务是判断一组可能存在歧义的实体名称中，哪些应合并为同一实体（如别名、简称、敬称等），哪些应视为独立实体。\n\n请基于**故事叙事与角色身份**进行判断：即使名称相似，如果在剧情中代表不同的身份、伪装者、替身、平行世界版本、不同阶段的角色等，也不得合并。\n\n以下是需要分析的实体信息：\n\n{entity_descriptions}\n\n---\n\n## 判定规则（务必遵循）\n1. **名称相似性**：考虑拼写接近、称谓风格一致等，但仅作辅助证据，不能单独决定合并。\n2. **身份与语义一致性**：需描述相同的角色身份、背景、行为特征与叙事功能。\n3. **剧情与阵营一致性**：需处于相同的故事设定、阵营、时间线或世界观。\n4. **冲突与差异优先**：若存在对立关系、替身/化名与本名分离、平行版本、不同阶段人格/载体，**不得合并**。\n5. **型号/版本区分**：名称包含型号、编号、批次、版本（如“Pro”“2021”“550A”）时，**视为不同实体**。\n6. **实例优先（关键）**：当对比项为**具体个体**（专有名/昵称/呼号/唯一编号） vs **通用类别/物种/职位/器材通名**时，**不得把个体合并进类别名**。若确认为同一对象的不同称呼，应以**个体名为主名称（canonical）**，类别名仅可作为别名；若类别名只是泛指，不指向唯一体，则应**不合并**并将其归入 `unmerged`。\n7. **命名优先级（从高到低）**：**专有名（本名/固定译名） > 稳定昵称/绰号 > 呼号/代号 > 职务/角色称谓 > 物种/类别通名**。当合并成立时，以优先级更高者作为 `canonical_name`。\n8. **语言与翻译变体**：同一实体的正名在中英/译名/音译/简繁体变体之间可合并；但**译名差异不能跨越身份/版本差异**。\n9. **同类多实例**：对机器人、宠物、士兵等同类对象，如缺乏唯一性标识或叙事连续绑定，默认**不合并**。\n\n---\n\n## 输出格式（严格遵循）\n请以如下 JSON 格式返回判断结果：\n\n```json\n{{\n  \"merges\": [\n    {{\n      \"canonical_name\": \"主名称\",\n      \"aliases\": [\"别名1\", \"别名2\"],\n      \"reason\": \"合并原因简要说明（引用上述规则编号）\"\n    }}\n  ],\n  \"unmerged\": [\n    {{\n      \"name\": \"未合并名称\",\n      \"reason\": \"不应合并的原因简要说明（引用上述规则编号）\"\n    }}\n  ]\n}}\n```\n\n如所有名称都不应合并，则 `merges` 置为空数组，全部放入 `unmerged`。请严格只返回该 JSON 对象，不要输出其他说明。",
  "variables": [
    {
      "name": "entity_descriptions",
      "description": "Provide a brief description for each entity name (e.g., type, identity, behavior, faction, context, appearance scene)"
    }
  ]
}