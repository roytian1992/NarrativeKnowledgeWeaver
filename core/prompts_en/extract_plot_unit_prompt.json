{
  "id": "generate_plot_prompt",
  "category": "regular_function",
  "name": "Event Chain → Plot Determination and Generation (Concise and Robust Version)",
  "description": "Based on a single input text, determine if an event chain constitutes a plot and output structured information if it does; compatible with turning point/conclusion plots for single events.",
  "template": "You are an expert in narrative structure analysis.\nTask: Based solely on the following input, determine if this event chain constitutes a plot unit and, if so, output structured plot information. Strictly forbid speculating on information outside the input; if missing, allow filling in 'unknown'.\n\n[Input]\n{event_chain_info}\n\n[Explanation Segment Convention]\nIf a card's scene/evidence/text contains tags like 'animated interpretation/news commentary/narration/recollection/dream/OS (off-screen sound)', it is considered an explanation segment. Explanation segments can appear but cannot solely constitute a plot, and their quantity in the entire chain must be ≤1.\n\n[Judgment Rules (3+1)]\nG (Goal - Same Goal): Events within the chain revolve around the same plan/task/conflict (a unified theme or tag can be extracted from name/summary/action/result/evidence).\nO (Order - Explainable Order): The given order makes sense; if an explanation segment is included, non-linearity is allowed but must not exceed 1, and must be closely tied to and support adjacent real events.\nC (Continuity): Adjacent events are continuous in at least one of 'participants' or 'location'.\n+1 (Outcome - Result/Turning Point): At least 1 event in the chain has a clear result or turning point.\n→ If G, O, and C are all met and there is an Outcome, it is judged as a plot; otherwise, it is not established.\nSingle Event Exception: Must have both 'identifiable goal/motive' and 'clear result/turning point'; otherwise, it is not established.\n\n[Output Format (Strictly Follow)]\nPlease strictly output the following JSON object, without any extra explanations or prefixes:\n\n{{\n  \"is_plot\": \"true or false\",\n  \"reason\": \"Briefly explain the judgment reason, control within 3-5 sentences\",\n  \"plot_info\": {{\n    \"title\": \"Generate a unique and easily distinguishable title for this plot (no more than 20 characters), which must incorporate key information from the event chain, such as location, key characters, time nodes, or results, rather than just generalized thematic words. Ensure that titles for different event chains with the same theme can also be clearly distinguished.\",\n    \"summary\": \"If it constitutes a plot, describe the main content of the plot completely in 100-200 words, covering key characters, locations, conflicts, and endings, to avoid confusion with descriptions of other plot chains.\",\n    \"main_characters\": [\"Character A\", \"Character B\"],\n    \"locations\": [\"Location A\", \"Location B\"],\n    \"time\": \"Description of the approximate time range of the plot, such as 'within an hour after the explosion', 'on the eve of the mission start', etc.\",\n    \"theme\": \"Plot theme, such as 'sacrifice', 'betrayal', 'reunion', etc.\",\n    \"goal\": \"Main task or goal, such as 'preventing crisis', 'rescuing hostages', etc.\",\n    \"conflict\": \"Main conflict or obstacle, such as 'resource shortage', 'enemy obstruction', etc.\",\n    \"resolution\": \"Result or ending of the plot, such as 'success', 'failure', 'sacrifice', etc.\"\n  }}\n}}\n\n- If is_plot=false, then plot_info must be {{}}.\n- Only use information from the input for filling; array elements are strings.",
  "variables": [
    {
      "name": "event_chain_info",
      "description": "A single text block, first providing the event chain header (e.g., Event Chain: ent_a->ent_b->...), then providing each event_card individually (at least including: name/summary/location/participants/action/result/evidence; optional: time/scene_name/scene_id/plan_tags/mode)"
    }
  ]
}